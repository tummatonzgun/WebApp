{% extends "base.html" %}

{% block title %}‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏• - IE Function Portal{% endblock %}

{% block css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/result.css') }}">
{% endblock %}

{% block content %}
<div class="container">
    <!-- Page Header -->
    <div class="page-header">
        <div class="header-content">
            <i class="fas fa-chart-line header-icon"></i>
            <h1>‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•</h1>
            <p class="header-subtitle">‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì</p>
        </div>
    </div>

    <!-- Flash Messages -->
    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
    <div class="alert-messages">
        {% for category, message in messages %}
        <div class="alert alert-{{ 'danger' if category == 'error' else category }} alert-dismissible">
            <i class="fas fa-{{ 'exclamation-triangle' if category == 'error' else 'info-circle' }}"></i>
            {{ message }}
            <button type="button" class="btn-close" onclick="this.parentElement.remove()">√ó</button>
        </div>
        {% endfor %}
    </div>
    {% endif %}
    {% endwith %}

    <!-- Statistics Dashboard -->
    <div class="stats-container">
        <div class="stats-grid" id="statsGrid">
            <!-- Statistics cards will be generated by JavaScript -->
        </div>
    </div>

    <!-- Navigation and Actions -->
    <div class="form-container">
        <div class="navigation-section">
            <div class="nav-group">
                <a href="{{ url_for('index') }}" class="btn btn-secondary">
                    <i class="fas fa-home"></i> ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å
                </a>
            </div>
            
            <div class="nav-group">
                {% if download_link %}
                <a href="{{ download_link }}" class="btn btn-success">
                    <i class="fas fa-download"></i> ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î Excel
                </a>
                {% endif %}
                
                <button id="toggleTable" class="btn btn-primary">
                    <i class="fas fa-table"></i> ‡πÅ‡∏™‡∏î‡∏á‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå
                </button>
            </div>
        </div>
    </div>

    <!-- Loading Indicator -->
    <div id="loading" class="loading">
        <div class="loading-content">
            <div class="loading-spinner">
                <i class="fas fa-cog fa-spin"></i>
            </div>
            <p>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏£‡∏≠‡∏™‡∏±‡∏Å‡∏Ñ‡∏£‡∏π‡πà...</p>
        </div>
    </div>

    <!-- Data Controls -->
    <div class="form-container" id="controlsContainer" style="display: none;">
        <div class="controls-section">
            <div class="form-group">
                <label class="form-label">
                    <i class="fas fa-filter"></i> ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏°‡∏∑‡∏≠‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•:
                </label>
                
                <div class="controls-grid">
                    <div class="control-item">
                        <input type="text" id="searchInput" class="form-control" 
                               placeholder="üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á...">
                    </div>
                    
                    <div class="control-item">
                        <button id="clearFiltersBtn" class="btn btn-secondary">
                            <i class="fas fa-eraser"></i> ‡∏•‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡∏Å‡∏£‡∏≠‡∏á
                        </button>
                    </div>
                </div>
                
                <div id="dropdownFilters" class="filters-container">
                    <!-- Dynamic filters will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Results Table -->
    <div class="form-container" id="tableContainer">
        <div class="table-section">
            <div class="form-group">
                <label class="form-label">
                    <i class="fas fa-table"></i> ‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•:
                </label>
                
                <div class="table-wrapper" id="tableArea">
                    {% if table_html %}
                        {{ table_html|safe }}
                    {% else %}
                        <div class="empty-state">
                            <div class="empty-icon">
                                <i class="fas fa-table"></i>
                            </div>
                            <h3>‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ï‡∏≤‡∏£‡∏≤‡∏á</h3>
                            <p>‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ú‡∏•‡∏•‡∏±‡∏û‡∏ò‡πå‡∏à‡∏≤‡∏Å‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∞‡∏°‡∏ß‡∏•‡∏ú‡∏•</p>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Detail Modal -->
    <div id="detailModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3 class="modal-title">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•</h3>
                <button type="button" class="btn-close" onclick="this.closest('.modal').style.display='none'">√ó</button>
            </div>
            <div class="modal-body">
                <!-- Modal content will be populated here -->
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block js %}
<script src="{{ url_for('static', filename='js/result.js') }}"></script>
{% endblock %}